# 프로그램 디자인

## 1.  프로젝트의 시작

프로젝트를 새로 시작하거나 기존에 구현했던 프로그램을 개선하기 시작할 때 순서

##### 1. 요구사항 분석

요구사항 분석 단계에서 가장 핵심적인 결과는 기능 요구사항이다.

- 기능 요구사항 작성

  >  코드가 정확히 할 일만 표현하고, 그 일을 달성하는 구체적인 방법은 생략한다.

- 비기능 요구사항 작성

  > 최종 결과로 나오는 시스템에 대한 동작이 아닌 속성을 표현한다. (보안, 확장성, 성능 기준 등등 )

>  요구사항 분석은 일반적으로 문서 형태로 작성한다.



##### 2. 프로그램 디자인

프로그램 디자인이란 요구사항 분석 단계에서 결과로 도출 된 요구사항을 모두 만족하는 프로그램을 구현하기 위한 구조에 대한 명세서, 즉 프로그램 구현 계획을 정리한 것이다.

프로젝트를 여러 팀원이 나눠서 진행하려면 모든 팀원이 공통적으로 따르는 디자인을 반드시 문서 형태로 마련해야 한다.

> 문서 형태는 UML툴을 사용해서 다이어그램 형태로 구성한다.
>
> 참고자료: [UML에 대해서]

- 디자인 문서 포맷 구성

  - 프로그램을 구성하는 서브시스템

    > 인터페이스와 서브시스템 사이의 의존성, 서브시스템 사이의 데이터 흐름, 서브시스템에 대한 입출력, 기본 스레드 활용 모델

  - 서브시스템별 세부사항

    >  클래스 구성, 클래스 계층도, 데이터 구조, 알고리즘, 개별 스레드 활용 모델, 에러 처리 방법

- C++에 적합한 디자인 방법

  C++ 프로그램을 디자인할 때 C++언어의 특성을 반드시 명심하자.

  - C++에서 제공하는 기능이 방대하다는 것을 알아두자.

  - C++는 객체지향 언어이다.

    > 디자인 단계에서 클래스 계증, 클래스 인터페이스, 객체의 상호작용을 결정해야 한다.

  - C++는 여러 가지 유용한 표준 라이브러리를 제공한다.

    > 스트링 클래스, I/O 기능, 데이터 구조와 알고리즘 등

  - C++는 다양한 디자인 패턴이나 널리 알려진 문제 해결 기법을 곧바로 적용하기 좋다.

> P. 200 참고



## 2. C++ 디자인에 관련된 두 가지 원칙

#### 추상화

- 내부 구현 방식을 이해하지 않아도 코드를 사용할 수 있다.

- 내부 구현과 외부 인터페이스가 명확히 분리돼 있고, 구현사항을 인터페이스 뒤로 숨기는 디자인이 추상화가 적용된 디자인이다.

- 함수화 클래스를 디자인할 때는 작성자 자신뿐만 아니라 다른 프로그래머가 내부 구현사항을 몰라도 쉽게 사용할 수 있게 구성해야 한다.

#### 재사용

재사용 원칙은 직접 작성한 코드뿐만 아니라 가져다 쓰는 코드에도 똑같이 적용된다.

디자인할 때 기존 코드가 있다면 이를 재사용할 수 있는지 반드시 검토하자.

- ##### 재사용 가능한 코드 만들기

  - 프로그램은 클래스, 알고리즘, 데이터 구조를 재사용할 수 있도록 디자인해야 한다.
  - 당장 주어진 문제에만 적용할 수 있도록 너무 특화된 형태로 디자인하는 것은 피하자.
  - C++은 코드를 범용적으로 만들 수 있도록 **템플릿**이라는 기능을 제공한다.

- ##### 디자인 재사용

  - 프로그램을 디자인할 때 기존의 디자인 패턴을 활용해서 비슷한 테크닉을 구현하자.
  - 디자인을 효율적으로 재사용 하려면 여러 가지 패턴과 기법을 잘 익혀둬야 한다.



## 3. 코드 재사용

경험이 풍부한 C++ 프로그래머라면 프로젝트를 구성하는 코드를 무잓정 처음부터 작성하지 않는다. 표준 라이브러리, 오픈소스 라이브러리, 회사에서 구매한 상용 코드, 예전 프로젝트에서 작성했던 코드를 비롯하여 다양한 소스를 최대한 활용한다. 그러기 위해선  주어진 디자인에서 코드를 자유자재로 활용할 수 있어야 한다. 이 원칙을 최대한 적용하려면 재사용할 수 있는 코드의 형태와 코드를 재사용할 때의 장단점을 명확히  파악해야 한다.

##### 1. 재사용 가능한 코드의 구분

- 예전에 자신이 작성했던 코드
- 동료가 작성한 코드
- 현재 소속 회사나 조직 외의 서드파티에서 작성한 코드



##### 2. 재사용할 코드를 만드는 형식

- 독립 함수 또는 클래스

  > 자신 또는 동료가 작성한 코드는 대부분 이런 형태로 재사용한다.

- 라이브러리

  > 특정한 작업을 처리하는 데 필요한 코드를 한데 묶은 것이다. 스레드와 동기화를 지원하거나 네트워킹, 그래픽 작업에 특화된 기능도 라이브러리로 구성하는 경우가 많다.

- 프레임워크

  > 디자인할 프로그램의 기반이 되는 코드를 모아둔 것이다. 
  >
  > 프레임워크에 따라 프로그램의 구성 방법까지 제시하기도 한다.

> 위의 라이브러리, 프레임워크 등을 비롯한 재사용 가능한 코드를 모두 **라이브러리**라고 표현한다.



##### 3. 코드 재사용의 판단 기준

어느 시점에 코드를 재사용하는 것이 적합한지 그리고 어느 코드를 재사용해야 할지는 상황에 맞게 결정해야 한다.

- 코드 재사용의 장점

> - 재사용한 코드로 구현한 컴포넌트는 디자인이 필요 없기 때문에 프로그램 전체에서 디자인 과정이 간결해진다.
>
> - 재사용한 코드는 대부분 이미 충분한 테스트와 검증 과정글 거쳤기 때문에 버그가 없다고 봐도 무방하다.
>
> - 라이브러리는 처음부터 새로 작성한 코드보다 훨씬 다양한 에러 상황에 대응하도록 작성됐다. 재사용할 수 있도록 제공되는 라이브러리는 대부분 엄격한 테스트를 거치고 수 많은 프로그래머가 검증했기 때문에 발생할 수 있는 에러는 거의 모두 잡혔다고 봐도 된다.
>
> - 라이브러리는 대체로 사용자가 값을 잘못 입력할 때도 적절히 대처하도록 작성된 경우가 많다. 잘못된 요청이나 상황에 맞지 않는 요청이 들어오면 에러가 발생한다고 경고한다.
>
> - 자신이 직접 작성한 코드보다 해당 분야의 전문가가 작성한 코드를 사용하는 것이 훨씬 안전하다. 
>
> - 라이브러리는 지속적으로 개선된다. 이러한 코드를 재사용하면 구현 시간도 절약할 수 있을 뿐만 아니라 개선된 효과를 그대로 누릴 수 있다.
>
>   > 라이브러리에서 인터페이스와 구현이 확실히 분리돼 있다면 그 라이브러리를 사용하는 코드를 수정하지 않고도 라이브러리 버전을 업그레이드 할 수 있다. 이상적인 럽그레이드 형태는 인터페이스를 변경하지 않고 내부 구현만 수정하는 것이다.

- 코드 재사용의 단점

> - 다른 사람이 작성한 라이브러리를 사용하기 위해서는 그 라이브러리에서 제공하는 인터페이스를 파악하고 올바른 사용법을 익히는데 시간이 걸린다.
> - 라이브러리에서 제공하는 기능은 자신이 원하는 바와 정확히 일치하지 않을 수도 있다.
> - 라이브러리에서 자신이 원하는 기능을 정확히 제공하더라도 원하는 만큼 성능이 나오지 않을 수 있다. 성능이 전반적으로 나쁜 수 있고, 특정한 상황에서만 안 좋게 나올 수 있고, 성능을 전혀 예측할 수 없을 수도 있다.
> - 라이브러리 코드를 사용하면 유지 보수에 문제가 발생할 수 있다. 라이브러리의 소스 코드에 접근할 수 없는 경우가 많은데, 그런 라이브러리에서 버그가 발생하면 직접 고치고 싶어도 고칠 수 없다.
> - 라이브러리를 사용하면 라이선스 문제도 발생할 수 있다. 라이브러리 코드를 사용한 것만으로 내가 직성한 코드까지 공개해야 하거나, 재배포 비용이 발생하거나, 개발용 라이선스를 구매해야 할 수 있다. **따라서 라이브러리를 사용하기 전에 라이선스 문제를 면밀히 검토해야 한다.**
> - 라이브러리를 새 버전으로 업그레이드할 떄 문제가 발생하기도 한다. 업그레이드된 버전에 있는 버그로 인해 나의 제품에 치명적인 영향을 미칠 수 있다.



##### 4. 코드 재사용 전략

재사용하려는 코드가 라이브러리든, 프레임워크든, 동료가 작성한 것이든, 내가 직접 작성한 것이든 관계없이 공통적으로 고려할 사항이 있다.

- 기능과 제약사항 파악하기

> 먼저 코드에 대한 문서와 공개된 인터페이스 또는 API부터 살펴본다. 사용하려는 라이브러리에서 인터페이스와 구현이 제대로 분리돼 있지 않으면 소스 코드를 직접 뒤져봐야 한다.
>
> 재사용 대상이 라이브러리라면 어떤 함수가 제공되는지 파악한다. 
>
> 프레임워크를 재사용한다면 코드 작성 방식부터 익히고, 어떤 클래스를 상속해야 할지, 직접 작성할 부분은 무엇인지 파악한다.
>
> ​       **가이드라인**
>
> - 멀티스레드 프로그램에서 사용해도 안전한지 파악한다.
> - 라이브러리를 사용하는 코드에 대해 특별히 컴파일러에 설정해야 할 사항이 있는지, 만약 그렇다면 프로젝트 전체에 적용해도 문제가 없는지 확인한다.
> - 초기화나 종료 시 만드시 수행할 작업이 있는지 확인한다.
> - 사용할 라이브러리나 프레임워크에서 의존하는 라이브러리가 있는지 확인한다.
> - 클래스를 상속할 때 어떤 생성자를 호출해야 하고, 어떤 가상 메서드를 오버라이드해야 하는지 파악한다.
> - 라이브러리를 호출할 때 어떤 에러 조건을 확인해야 하는지, 이때 어떤 상황을 가정하는지 파악한다. 에러를 팝업 메시지를 띄워 알려주거나 그냥 프로그램을 종료시켜버리는 라이브러리는 피한다.
> - 함수가 메모리 포인터를 리턴할 때 그 메모리를 해제하는 작업을 호출한 코드와 라이브리 중 어느 쪽이 책임져야 하는지 파악한다. 라이브러리에서 처리해준다면 메모리가 해제되는 시점을 파악한다.
> - 함수에서 리턴하는 값이나 레퍼런스를 모두 파악한다.
> - 함수에서 발생하는 익셉션을 모두 파악한다.

- 성능 파악하기

  개발하려는 프로그램이 성능에 민감하지 않더라도 재사용하려는 코드의 성능이 특정 상황에서 문제가 발생할 정도로 나쁘지 않은지 반드시 확인해야 한다.

> **빅오 표기법 **  194
>
> 빅오 표기법은 성능을 상대적으로 표기한다.
>
> **복잡도**: 빅오 표기법을 알고리즘의 실행 시간을 입력 크기에 대한 함수로 표현한 것.  ex) 입력 크기에 따라 실행 시간이 일정하게 증가 == 선형 복잡도를 갖는다.
>
> 선형 성능을 가지는 알고리즘을 빅오 표기법으로 O(n) 이라고 표기한다. (n: 입력 크기)
>
> 성능을 입력 크기에 대한 함수로 표현하면 그 알고리즘에 대해 주어질 수 있는 모든 입력값을 한마디로 표현할 수 있다.
>
> > 추가 내용

- 플랫폼 제약사항 파악하기

> 라이브러리 코드를 사용하기 전에 그 코드를 실행할 플랫폼부터 확실히 파악한다.

- 라이선스와 기술 지원 파악하기

> 서드파티 라이브러리를 사용할 때 기술 지원 문제, 라이선스 문제, 버그 리포트 절차나 버그 수정이 완료될 때까지 걸리는 기간 등도 반드시 파악한다.

- 도움을 받을 수 있는 곳 파악하기

> 라이브러리를 사용할 때 함께 제공되는 문서부터 살펴본다. 
>
> 표준 라이브러리나 널리 사용되는 라이브러리라면 이에 대해 잘 성명하고 있는 책이 있다. 
>
> 또한 특정한 주제만 집중적으로 다루는 사설 뉴스 그룹이나 포럼도 많으니 원하는 곳에 가입해서 궁금증을 해결하자.

- 프로토타입 구현하기.

> 라이브러리나 프레임워크를 처음 사용할 때 간단히 프로토타입을 구연해보는 것도 도움이 된다.
>
> 라이브러리에서 제공하는 기능을 익히는 가장 좋은 방법은 직접 코드를 작성해보는 것이다.



##### 5. 오픈소스 라이브러리

- 두 가지 오픈 소스 운동

> - 자유 소프트웨어
>
> > 개발자는 소프트웨어의 가격을 얼마든지 정할 수 있는 자유가 있다.
>
> - 오픈소스 소프트웨어
>
> > 소스 코드를 사용하고, 수정하고, 재배포할 자유를 반드시 보장할 필요가 없다.

- 오픈소스 코드 활용 방법

> 오픈소스 라이브러리는 상용 재품과 접근 방식이 다르다. 
>
> 누구나 개발하거나 기여하거나 버그를 수정할 수 있도록 소스 코드를 수정하는 권한도 대부분 열려 있다.



##### 6. C++ 표준 라이브러리

> C++는 C언어보다 향상된 스트링 및 I/O 기능을 제공한다. C++에서 스트링과 I/O를 C스타일로 처리해도 되지만, 그보다는 C++에서 제공하는 스트링과 I/O 스트림을 활용하는 것이 바람직하다.
>
> C++에서는 C 에서 사용하던 라이브러리 이름 대신 C++에서 정한 이름을 따라야 이름끼리 충돌할 가능성이 적다.
>
> 표준 라이브러리는 기능, 성능, 직교성을 위주로 디자인한 것이다.


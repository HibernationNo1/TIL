# RAID 6 예시

### 전제조건

- **모든 데이터는 0과 1로 이루어져 있다.**

  데이터 A: **`1101101010010110`**

  데이터 B: **`1010101111001101`**

  데이터 C: **`1110010101010111`**

  데이터 D: **`1001110010101001`**

- **위와 같은 데이터가 있을 때, 데이터를 4개의 데이터 블록으로 나누면**
  A1, A2, A3, A4는 1101, 1010, 1001, 0110 과 같으며, 다른 B, C, D도 동일하게 적용한다.

- **이 때  아래와 같은 규칙에 의해 패리티 데이터가 구성된다.**

  **패리티 블록 1**  P1 = A1 ⊕ B2 ⊕ C3 ⊕ D4  

  **패리티 블록 2**  Q1 =  (A1 ⊕ B2) ⊕ (C3 ⊕ D4)    # 간단히 예를 든 것. 

  > - ⊕는 XOR를 의미
  > - 예시를 위해 쉽게 표현한것이지만 실제로 블록 Q는 Reed-Solomon 코드를 사용하여 더욱 복잡한 과정을 통해 생성된다.

  위와 같을 때, 각 패리티 블록은 아래와 같이 계산된다.

  - **P1** = `A1 ⊕ B2 ⊕ C3 ⊕ D4` = `1101 ⊕ 1011 ⊕ 0101 ⊕ 1001` = 1010
  - **P2** = `A2 ⊕ B3 ⊕ C4 ⊕ D1` = `1010 ⊕ 1100 ⊕ 0111 ⊕ 1001` = 1000
  - **P3** = `A3 ⊕ B4 ⊕ C1 ⊕ D2` = `1001 ⊕ 1101 ⊕ 1110 ⊕ 1100` = 0110
  - **P4** = `A4 ⊕ B1 ⊕ C2 ⊕ D3` = `0110 ⊕ 1010 ⊕ 0101 ⊕ 1010` = 0011
  - **Q1** = `(A1 ⊕ B2) ⊕ (C3 ⊕ D4)` = `(1101 ⊕ 1011) ⊕ (0101 ⊕ 1001)` = 1110
  - **Q2** = `(A2 ⊕ B3) ⊕ (C4 ⊕ D1)` = `(1010 ⊕ 1100) ⊕ (0111 ⊕ 1001)` = 1000
  - **Q3** = `(A3 ⊕ B4) ⊕ (C1 ⊕ D2)` = `(1001 ⊕ 1101) ⊕ (1110 ⊕ 1100)` = 0110
  - **Q4** = `(A4 ⊕ B1) ⊕ (C2 ⊕ D3)` = `(0110 ⊕ 1010) ⊕ (0101 ⊕ 1010)` = 0011

- 디스크 구조는 아래와 같다

  ```
  디스크 1: A1 | B1 | C1 | D1 | P1 | Q1	==	1101 | 1010 | 1110 | 1001 | 1000 | 0000 
  디스크 2: A2 | B2 | C2 | D2 | P2 | Q2	==	1010 | 1011 | 0101 | 1100 | 1000 | 1000 
  디스크 3: A3 | B3 | C3 | D3 | P3 | Q3	==	1001 | 1100 | 0101 | 1010 | 1010 | 1010  
  디스크 4: A4 | B4 | C4 | D4 | P4 | Q4	==	0110 | 1101 | 0111 | 1001 | 0001 | 0101 
  디스크 5: P1 | P2 | P3 | P4 | D1 | D2	==	1000 | 1000 | 1010 | 0001 | 1001 | 1100 
  디스크 6: Q1 | Q2 | Q3 | Q4 | D3 | D4	==	0000 | 1000 | 1010 | 0101 | 1010 | 1001
  ```

  



### 디스크 1을 잃었을 때

- **A1 복구**

  A1 = `P1 ⊕ B2 ⊕ C3 ⊕ D4` = `1010 ⊕ 1011 ⊕ 0101 ⊕ 1001 ` = 1101

  - P1 = 1010 (디스크 5)
  - B2 = 1011 (디스크 2)
  - C3 = 0101 (디스크 3)
  - D4 = 1001 (디스크 4)

- **B1 복구**

  B1 = `P2 ⊕ A2 ⊕ C4 ⊕ D1` = `1000 ⊕ 1010 ⊕ 0111 ⊕ 1001` = 1010

  - P2 = 1000 (디스크 5)
  - A2 = 1010 (디스크 2)
  - C4 = 0111 (디스크 4)
  - D1 = 1001 (디스크 5)

- **C1 복구**

  C1 = `P3 ⊕ A3 ⊕ B4 ⊕ D2` = `0110 ⊕ 1001 ⊕ 1101 ⊕ 1100` = 1110

  - P3 = 0110 (디스크 5)
  - A3 = 1001 (디스크 3)
  - B4 = 1101 (디스크 4)
  - D2 = 1100 (디스크 3)

- **D1 복구**

  C1 = `P4 ⊕ A4 ⊕ B1 ⊕ C2` = `0011 ⊕ 0110 ⊕ 1010 ⊕ 0101` = 1001

  - P4 = 0011 (디스크 5)
  - A4 = 0110 (디스크 4)
  - B1 = 1010 (디스크 2)
  - C2 = 0101 (디스크 2)



